{
    "$schema":"http://json-schema.org/draft-04/schema#",
    "definitions":{
        "clouds":{
            "oneOf":[
                {
                    "$geoweb::messages":{
                        "maxItems":"Four cloud groups are only possible if the fourth cloud has CB or TCU and the former three cloud groups have no such qualifiers"
                    },
                    "items":[
                        {
                            "$ref":"#/definitions/first_cloud_mod"
                        },
                        {
                            "$ref":"#/definitions/second_cloud_mod"
                        },
                        {
                            "$ref":"#/definitions/third_cloud_mod"
                        }
                    ],
                    "maxItems":3,
                    "minItems":0,
                    "type":"array"
                },
                {
                    "items":[
                        {
                            "$ref":"#/definitions/first_cloud"
                        },
                        {
                            "$ref":"#/definitions/second_cloud"
                        },
                        {
                            "$ref":"#/definitions/third_cloud"
                        },
                        {
                            "$ref":"#/definitions/fourth_cloud"
                        }
                    ],
                    "maxItems":4,
                    "minItems":4,
                    "type":"array"
                },
                {
                    "enum":[
                        "NSC"
                    ],
                    "type":"string"
                }
            ]
        },
        "cloud_height_0_5000FT":{
            "oneOf":[
                {
                    "$geoweb::messages":{
                        "maximum":"Clouds without CB cannot be higher than 5000 ft",
                        "minimum":"Clouds cannot be lower than 0 ft",
                        "multipleOf": "When cloud height is between 0 and 5000 ft, it must be a multiple of 100 ft"
                    },
                    "maximum":49,
                    "minimum":0,
                    "multipleOf": 1,
                    "type":"integer"
                }
            ]
        },
        "cloud_height_0_10000FT":{
            "oneOf":[
                {
                    "$geoweb::messages":{
                        "multipleOf": "When cloud height is between 0 and 5000 ft, it must be a multiple of 100 ft"
                    },
                    "maximum":49,
                    "minimum":0,
                    "multipleOf": 1,
                    "type":"integer"
                }, {
                    "$geoweb::messages":{
                        "maximum":"Clouds without CB cannot be higher than 5000 ft",
                        "minimum":"Clouds cannot be lower than 0 ft",
                        "multipleOf": "When cloud height is between 5000 ft and 10000 ft, it must be a multiple of 1000 ft"
                    },
                    "maximum":999,
                    "minimum":50,
                    "multipleOf": 10,
                    "type":"integer"
                }
            ]
        },
        "first_cloud":{"oneOf":[{
            "additionalProperties":false,
            "properties":{
                "amount":{
                    "$geoweb::messages":{
                        "enum":"First cloud group can only be one of few, scattered, broken, or overcast"
                    },
                    "enum":[
                        "FEW",
                        "SCT",
                        "BKN",
                        "OVC"
                    ],
                    "type":"string"
                },
                "height":{
                    "$ref":"#/definitions/cloud_height_0_5000FT"
                }
            },
            "required":[
                "amount",
                "height"
            ],
            "type":"object"
        },{
            "additionalProperties":false,
            "properties":{
                "amount":{
                    "$geoweb::messages":{
                        "enum":"First cloud group with TCU or CB can only be one of few, scattered, broken, or overcast"
                    },
                    "enum":[
                        "FEW",
                        "SCT",
                        "BKN",
                        "OVC"
                    ],
                    "type":"string"
                },
                "height":{
                    "$ref":"#/definitions/cloud_height_0_10000FT"
                },"mod":{
                            "enum":[
                                "TCU", "CB"
                            ],
                            "type":"string"
                        }
            },
            "required":[
                "amount",
                "height",
                "mod"
            ],
            "type":"object"
        }]},
        "first_cloud_mod":{"oneOf":[{
            "additionalProperties":false,
            "properties":{
                "amount":{
                    "$geoweb::messages":{
                        "enum":"First cloud group can only be one of few, scattered, broken, or overcast"
                    },
                    "enum":[
                        "FEW",
                        "SCT",
                        "BKN",
                        "OVC"
                    ],
                    "type":"string"
                },
                "height":{
                    "$ref":"#/definitions/cloud_height_0_5000FT"
                }
            },
            "required":[
                "amount",
                "height"
            ],
            "type":"object"
        },{
            "additionalProperties":false,
            "properties":{
                "amount":{
                    "$geoweb::messages":{
                        "enum":"First cloud group can only be one of few, scattered, broken, or overcast"
                    },
                    "enum":[
                        "FEW",
                        "SCT",
                        "BKN",
                        "OVC"
                    ],
                    "type":"string"
                },
                "height":{
                    "$ref":"#/definitions/cloud_height_0_10000FT"
                },    "mod":{
                            "enum":[
                                "TCU", "CB"
                            ],
                            "type":"string"
                        }
            },
            "required":[
                "amount",
                "height",
                "mod"
            ],
            "type":"object"
        }]},
        "second_cloud":{"oneOf":[{
            "additionalProperties":false,
            "properties":{
                "amount":{
                    "$geoweb::messages":{
                        "enum":"Second cloud group can only be one of scattered, broken, or overcast"
                    },
                    "enum":[
                        "SCT",
                        "BKN",
                        "OVC"
                    ],
                    "type":"string"
                },
                "height":{
                    "$ref":"#/definitions/cloud_height_0_5000FT"
                }
            },
            "required":[
                "amount",
                "height"
            ],
            "type":"object"
        },{
            "additionalProperties":false,
            "properties":{
                "amount":{
                    "$geoweb::messages":{
                        "enum":"Second cloud group can only be one of scattered, broken, or overcast"
                    },
                    "enum":[
                        "SCT",
                        "BKN",
                        "OVC"
                    ],
                    "type":"string"
                },
                "height":{
                    "$ref":"#/definitions/cloud_height_0_10000FT"
                },"mod":{
                            "enum":[
                                "TCU", "CB"
                            ],
                            "type":"string"
                        }
            },
            "required":[
                "amount",
                "height",
                "mod"
            ],
            "type":"object"
        }]},
        "second_cloud_mod":{
            "oneOf":[
                {
                    "additionalProperties":false,
                    "properties":{
                        "amount":{
                            "$geoweb::messages":{
                                "enum":"Second cloud group can only be one of scattered, broken, or overcast"
                            },
                            "enum":[
                                "SCT",
                                "BKN",
                                "OVC"
                            ],
                            "type":"string"
                        },
                        "height":{
                            "$ref":"#/definitions/cloud_height_0_5000FT"
                        }
                    },
                    "required":[
                        "amount",
                        "height"
                    ]
                },
                {
                    "additionalProperties":false,
                    "properties":{
                        
                        "amount":{
                        "$geoweb::messages":{
                            "enum":"Third cloud group with CB or TCU can be broken, overcast, few, or scattered"
                        },
                            "enum":[
                                "SCT",
                                "BKN",
                                "OVC",
                                "FEW"
                            ],
                            "type":"string"
                        },
                        "height":{
                            "$ref":"#/definitions/cloud_height_0_10000FT"
                        },
                        "mod":{
                            "enum":[
                                "TCU", "CB"
                            ],
                            "type":"string"
                        }
                    },
                    "required":[
                        "amount",
                        "height",
                        "mod"
                    ]
                }
            ],
            "type":"object"
        },
        "third_cloud":{
            "oneOf":[
                {
                    "additionalProperties":false,
                    "properties":{
                        "amount":{
                            "$geoweb::messages":{
                                "enum":"Third cloud group can only be broken or overcast"
                            },
                            "enum":[
                                "BKN",
                                "OVC"
                            ],
                            "type":"string"
                        },
                        "height":{
                            "$ref":"#/definitions/cloud_height_0_5000FT"
                        }
                    },
                    "required":[
                        "amount",
                        "height"
                    ]
                },
                {
                    "additionalProperties":false,
                    "properties":{
                        "amount":{
                            "$geoweb::messages":{
                                "enum":"Third cloud group with CB or TCU can be broken, overcast, few, or scattered"
                            },
                            "enum":[
                                "SCT",
                                "BKN",
                                "OVC",
                                "FEW"
                            ],
                            "type":"string"
                        },
                        "height":{
                            "$ref":"#/definitions/cloud_height_0_10000FT"
                        },
                        "mod":{
                            "enum":[
                                "TCU", "CB"
                            ],
                            "type":"string"
                        }
                    },
                    "required":[
                        "amount",
                        "height",
                        "mod"
                    ]
                }
            ],
            "type":"object"
        },
        "third_cloud_mod":{
            "oneOf":[
                {
                    "additionalProperties":false,
                    "properties":{
                        "amount":{
                            "$geoweb::messages":{
                                "enum":"Third cloud group without CB can only be broken or overcast (mod)"
                            },
                            "enum":[
                                "BKN",
                                "OVC"
                            ],
                            "type":"string"
                        },
                        "height":{
                            "$ref":"#/definitions/cloud_height_0_5000FT"
                        }
                    },
                    "required":[
                        "amount",
                        "height"
                    ],
                    "type":"object"
                }, 
                {
                    "additionalProperties":false,
                    "properties":{
                        "amount":{
                            "$geoweb::messages":{
                                "enum":"Third cloud group with CB or TCU can be broken, overcast, few, or scattered (mod)"
                            },
                            "enum":[
                                "BKN",
                                "OVC",
                                "FEW",
                                "SCT"
                            ],
                            "type":"string"
                        },
                        "height":{
                            "$ref":"#/definitions/cloud_height_0_10000FT"
                        },
                        "mod":{
                            "enum":[
                                "TCU", "CB"
                            ],
                            "type":"string"
                        }
                    },
                    "required":[
                        "amount",
                        "height",
                        "mod"
                    ],
                    "type":"object"
                }
            ],
            "type":"object"
        },
        "fourth_cloud":{
            "oneOf":[
                {
                    "additionalProperties":false,
                    "properties":{
                        "amount":{
                            "$geoweb::messages":{
                                "enum":"Fourth cloud group can only be broken or overcast"
                            },
                            "enum":[
                                "BKN",
                                "OVC",
                                "FEW",
                                "SCT"
                            ],
                            "type":"string"
                        },
                        "height":{
                            "$ref":"#/definitions/cloud_height_0_10000FT"
                        },
                        "mod":{
                            "enum":[
                                "TCU", "CB"
                            ],
                            "type":"string"
                        }
                    },
                    "required":[
                        "mod",
                        "height",
                        "amount"
                    ],
                    "type":"object"
                }
            ],
            "type":"object"
        }
    }
}